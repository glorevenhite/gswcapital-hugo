<script type="text/javascript">
    {{ $urlfull := delimit (slice .Site.BaseURL "csv/20161007-count.csv") ""}}
    {{ $strUrl := string $urlfull }}
   
    $(document).ready(function() {
        {{ $url := delimit (slice "../../csv/20161007-count.csv") ""}}
        var options = {
            chart: { 
                renderTo: 'avin-count',
                plotBackgroundColor: null,
                plotBorderWidth: null,
                plotShadow: false,
                type: 'pie'
            },
            title: {
              text: 'AVIN\u2122 Universe Structure (Count)'
            },
            tooltip: {
                    pointFormat:'{point.y:.0f}</b>'
            },
            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    cursor: 'pointer',
                    showInLegend: true       
                }
            },
            series: []
        };

        var s = { 
              type : "pie",
              colorByPoint: true,
              data: []
        };

        {{ $dataCSV := getCSV "," $strUrl }}
        {{ $.Scratch.Add "i" 0 }}

        {{ range $r, $dataCSV }}
            {{ if gt ($.Scratch.Get "i") 0 }}
                var name = {{ index $r 0 }};
                var y = parseFloat({{ index $r 1 }}); 
                s.data.push({name, y});
            {{ end }}
            // increase index
            {{ $i := $.Scratch.Get "i" }}
            {{ $i := add $i 1}}
            {{ $.Scratch.Set "i" $i}}
        {{ end }}

        options.series.push(s);

        var chart = new Highcharts.Chart(options);
    });
</script>
<div id="avin-count" style="float:left; min-width: 350px; max-width:50%; height: 400px; margin: auto 0"></div>